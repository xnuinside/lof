{
   "AWSTemplateFormatVersion": "2010-09-09",
   "Transform": "AWS::Serverless-2016-10-31",
   "Description": "sam-python-crud-sample SAM Template for sam-python-crud-sample\n",
   "Globals": {
      "Function": {
         "Timeout": 60
      }
   },
   "Parameters": {
      "Table": {
         "Type": "String",
         "Default": "Activities"
      },
      "Region": {
         "Type": "String",
         "Default": "us-east-1"
      },
      "AWSEnv": {
         "Type": "String",
         "Default": "AWS"
      }
   },
   "Resources": {
      "CreateActivityFunction": {
         "Type": "AWS::Serverless::Function",
         "Properties": {
            "CodeUri": "src/create_activity/",
            "Handler": "app.lambda_handler",
            "Runtime": "python3.8",
            "Environment": {
               "Variables": {
                  "TABLE": null,
                  "REGION": null,
                  "AWSENV": null
               }
            },
            "Events": {
               "CreateActivities": {
                  "Type": "Api",
                  "Properties": {
                     "Path": "/activities",
                     "Method": "post"
                  }
               }
            },
            "Policies": [
               {
                  "DynamoDBCrudPolicy": {
                     "TableName": null
                  }
               }
            ]
         }
      },
      "GetActivityFunction": {
         "Type": "AWS::Serverless::Function",
         "Properties": {
            "CodeUri": "src/get_activity/",
            "Handler": "app.lambda_handler",
            "Runtime": "python3.8",
            "Environment": {
               "Variables": {
                  "TABLE": null,
                  "REGION": null,
                  "AWSENV": null
               }
            },
            "Events": {
               "CreateActivities": {
                  "Type": "Api",
                  "Properties": {
                     "Path": "/activities/{id}",
                     "Method": "get"
                  }
               }
            },
            "Policies": [
               {
                  "DynamoDBCrudPolicy": {
                     "TableName": null
                  }
               }
            ]
         }
      },
      "ListActivitiesFunction": {
         "Type": "AWS::Serverless::Function",
         "Properties": {
            "CodeUri": "src/list_activities/",
            "Handler": "app.lambda_handler",
            "Runtime": "python3.8",
            "Environment": {
               "Variables": {
                  "TABLE": null,
                  "REGION": null,
                  "AWSENV": null
               }
            },
            "Events": {
               "CreateActivities": {
                  "Type": "Api",
                  "Properties": {
                     "Path": "/activities/",
                     "Method": "get"
                  }
               }
            },
            "Policies": [
               {
                  "DynamoDBCrudPolicy": {
                     "TableName": null
                  }
               }
            ]
         }
      },
      "UpdateActivityFunction": {
         "Type": "AWS::Serverless::Function",
         "Properties": {
            "CodeUri": "src/update_activity/",
            "Handler": "app.lambda_handler",
            "Runtime": "python3.8",
            "Environment": {
               "Variables": {
                  "TABLE": null,
                  "REGION": null,
                  "AWSENV": null
               }
            },
            "Events": {
               "CreateActivities": {
                  "Type": "Api",
                  "Properties": {
                     "Path": "/activities/{id}",
                     "Method": "put"
                  }
               }
            },
            "Policies": [
               {
                  "DynamoDBCrudPolicy": {
                     "TableName": null
                  }
               }
            ]
         }
      },
      "DeleteActivityFunction": {
         "Type": "AWS::Serverless::Function",
         "Properties": {
            "CodeUri": "src/delete_activity/",
            "Handler": "app.lambda_handler",
            "Runtime": "python3.8",
            "Environment": {
               "Variables": {
                  "TABLE": null,
                  "REGION": null,
                  "AWSENV": null
               }
            },
            "Events": {
               "CreateActivities": {
                  "Type": "Api",
                  "Properties": {
                     "Path": "/activities/{id}/{date}",
                     "Method": "delete"
                  }
               }
            },
            "Policies": [
               {
                  "DynamoDBCrudPolicy": {
                     "TableName": null
                  }
               }
            ]
         }
      },
      "ActivitiesTable": {
         "Type": "AWS::DynamoDB::Table",
         "Properties": {
            "AttributeDefinitions": [
               {
                  "AttributeName": "id",
                  "AttributeType": "S"
               },
               {
                  "AttributeName": "date",
                  "AttributeType": "S"
               }
            ],
            "KeySchema": [
               {
                  "AttributeName": "id",
                  "KeyType": "HASH"
               },
               {
                  "AttributeName": "date",
                  "KeyType": "RANGE"
               }
            ],
            "ProvisionedThroughput": {
               "ReadCapacityUnits": "1",
               "WriteCapacityUnits": "1"
            },
            "TableName": "Activities"
         }
      }
   },
   "Outputs": {
      "ActivitiesApi": {
         "Description": "API Gateway endpoint URL for Prod stage for Create Activity Function",
         "Value": null
      },
      "CreateActivityFunction": {
         "Description": "Create Activity Lambda Function ARN",
         "Value": null
      },
      "CreateActivityFunctionIamRole": {
         "Description": "Implicit IAM Role created for Create Activity function",
         "Value": null
      },
      "GetActivityFunction": {
         "Description": "Get Activity Lambda Function ARN",
         "Value": null
      },
      "GetActivityFunctionIamRole": {
         "Description": "Implicit IAM Role created for Get Activity function",
         "Value": null
      },
      "ListActivitiesFunction": {
         "Description": "List Activities Lambda Function ARN",
         "Value": null
      },
      "ListActivitiesFunctionIamRole": {
         "Description": "Implicit IAM Role created for List Activities function",
         "Value": null
      },
      "UpdateActivityFunction": {
         "Description": "Update Activity Lambda Function ARN",
         "Value": null
      },
      "UpdateActivityFunctionIamRole": {
         "Description": "Implicit IAM Role created for Update Activity function",
         "Value": null
      },
      "DeleteActivityFunction": {
         "Description": "Delete Activity Lambda Function ARN",
         "Value": null
      },
      "DeleteActivityFunctionIamRole": {
         "Description": "Implicit IAM Role created for Delete Activity function",
         "Value": null
      },
      "ActivitiesTable": {
         "Description": "DynamoDB Table",
         "Value": null
      },
      "ActivitiesTableArn": {
         "Description": "DynamoDB Table ARN",
         "Value": null
      }
   }
}